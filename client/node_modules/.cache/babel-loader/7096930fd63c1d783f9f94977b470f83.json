{"ast":null,"code":"import _slicedToArray from\"/Users/kendric_chung/Projects/kingdo/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import _classCallCheck from\"/Users/kendric_chung/Projects/kingdo/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/Users/kendric_chung/Projects/kingdo/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";import _inherits from\"/Users/kendric_chung/Projects/kingdo/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";import _createSuper from\"/Users/kendric_chung/Projects/kingdo/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";import React,{Component}from\"react\";import TopBar from\"../Menu/MenuPage/TopBar\";import Typography from\"@material-ui/core/Typography\";import TextField from\"@material-ui/core/TextField\";import Button from\"@material-ui/core/Button\";import PhoneInput from\"material-ui-phone-number\";import{Redirect,Link}from\"react-router-dom\";import Card from\"@material-ui/core/Card\";import CardContent from\"@material-ui/core/CardContent\";import Center from\"react-center\";import Axios from\"axios\";import{Helmet}from\"react-helmet\";import{parseItemIntoStack}from\"../Cart/CartPage\";import MenuItem from\"@material-ui/core/MenuItem\";import FormControl from\"@material-ui/core/FormControl\";import Select from\"@material-ui/core/Select\";import buttonBackground from\"../kingdo_background.png\";var hostEndpoint=process.env.KINGDO_HOST_ENDPOINT?process.env.KINGDO_HOST_ENDPOINT:\"http://localhost:3001\";var OrderConfirmationPage=/*#__PURE__*/function(_Component){_inherits(OrderConfirmationPage,_Component);var _super=_createSuper(OrderConfirmationPage);function OrderConfirmationPage(props){var _this;_classCallCheck(this,OrderConfirmationPage);_this=_super.call(this,props);_this.handleFirstNameEdit=function(event){_this.setState({firstNameText:event.target.value,disabled:event.target.value.length===0||_this.state.lastNameText.length===0||_this.state.phoneNumber.length<=2||(_this.state.foodTransportationMethod===\"delivery\"?_this.state.deliveryAddress.length===0:false)});};_this.handleLastNameEdit=function(event){_this.setState({lastNameText:event.target.value,disabled:event.target.value.length===0||_this.state.firstNameText.length===0||_this.state.phoneNumber.length<=2||(_this.state.foodTransportationMethod===\"delivery\"?_this.state.deliveryAddress.length===0:false)});};_this.handleDeliveryAddressEdit=function(event){_this.setState({deliveryAddress:event.target.value,disabled:event.target.value.length===0||_this.state.firstNameText.length===0||_this.state.phoneNumber.length<=2||_this.state.lastNameText.length===0});};_this.handlePhoneNumberEdit=function(value){_this.setState({phoneNumber:value.replace(/\\(|\\)|-|\\s/g,\"\"),disabled:value.length<=2||_this.state.lastNameText.length===0||_this.state.firstNameText.length===0||(_this.state.foodTransportationMethod===\"delivery\"?_this.state.deliveryAddress.length===0:false)});};_this.handleRedirectToPlaceOrderConfirmPage=function(){try{var _parseItemIntoStack=parseItemIntoStack(JSON.parse(sessionStorage.getItem(\"cartItems\"))),_parseItemIntoStack2=_slicedToArray(_parseItemIntoStack,2),stackItems=_parseItemIntoStack2[0],cartItemsAmount=_parseItemIntoStack2[1];Axios(\"\".concat(hostEndpoint,\"/twilio/sms\"),{method:\"POST\",params:{customerPhoneNumber:_this.state.phoneNumber,firstName:_this.state.firstNameText,lastName:_this.state.lastNameText,transportationMethod:_this.state.foodTransportationMethod,deliveryAddress:_this.state.deliveryAddress},data:{stackItems:stackItems,cartItemsAmount:cartItemsAmount}}).then(function(response){console.log(response);sessionStorage.removeItem(\"cartItems\");});// TODO: need to check if number of valid if not show that they need to pick up on next screen\n}catch(error){console.log(error);}_this.setState({redirectToPlaceOrderConfirmPage:true});};_this.handleFoodTransportationMethodChange=function(event){sessionStorage.setItem(\"foodTransportMethod\",event.target.value===\"delivery\"?\"delivery\":\"pickup\");_this.setState({foodTransportationMethod:event.target.value,disabled:event.target.value===\"delivery\"?true:_this.state.firstNameText.length===0||_this.state.phoneNumber.length<=2||_this.state.lastNameText.length===0});};_this.state={firstNameText:\"\",lastNameText:\"\",phoneNumber:\"\",deliveryAddress:\"\",token:props.location.state,foodTransportationMethod:sessionStorage.getItem(\"foodTransportMethod\").includes(\"delivery\")?\"delivery\":\"pickup\",disabled:true,redirectToPlaceOrderConfirmPage:false};return _this;}_createClass(OrderConfirmationPage,[{key:\"render\",value:function render(){var _this2=this;if(!this.state.token){return/*#__PURE__*/React.createElement(Center,null,/*#__PURE__*/React.createElement(\"h1\",null,\"Please return to the main page \",/*#__PURE__*/React.createElement(Link,{to:\"/\"},\"here\"),\".\"));}if(this.state.redirectToPlaceOrderConfirmPage){return/*#__PURE__*/React.createElement(Redirect,{to:{pathname:\"/\".concat(this.state.foodTransportationMethod,\"/cart/order/confirmed/checkout\"),state:\"token\",phoneNumber:this.state.phoneNumber}});}return/*#__PURE__*/React.createElement(\"div\",null,/*#__PURE__*/React.createElement(Helmet,null,/*#__PURE__*/React.createElement(\"title\",null,\"King Do Restaurant | Order Confirm\")),/*#__PURE__*/React.createElement(TopBar,null),/*#__PURE__*/React.createElement(\"div\",{style:{padding:\"2%\",paddingRight:\"5%\",paddingLeft:\"5%\"}},/*#__PURE__*/React.createElement(Card,null,/*#__PURE__*/React.createElement(CardContent,null,/*#__PURE__*/React.createElement(\"div\",{style:{padding:\"2%\"}},/*#__PURE__*/React.createElement(Typography,{component:\"h2\",style:{fontSize:20}},\"Please fill in the following to confirm that you will be paying for your order.\"),/*#__PURE__*/React.createElement(Typography,{component:\"h2\",style:{fontSize:20,paddingBottom:\"2%\"}},\"Your payment will be received upon\",this.state.foodTransportationMethod===\"deliver\"?\" delivery\":\" pick up\",\".\"),/*#__PURE__*/React.createElement(Typography,{component:\"h2\",style:{fontSize:20,paddingBottom:\"1%\"}},\"You can still change between delivery and pick up here:\"),/*#__PURE__*/React.createElement(FormControl,{variant:\"outlined\",style:{width:\"25%\",paddingBottom:\"2%\"}},/*#__PURE__*/React.createElement(Select,{labelId:\"demo-simple-select-outlined-label\",id:\"demo-simple-select-outlined\",value:this.state.foodTransportationMethod,onChange:function onChange(event){return _this2.handleFoodTransportationMethodChange(event);}},/*#__PURE__*/React.createElement(MenuItem,{value:\"delivery\"},\"Delivery\"),/*#__PURE__*/React.createElement(MenuItem,{value:\"pickup\"},\"Pick Up\"))),/*#__PURE__*/React.createElement(\"div\",{style:{width:\"100%\",height:1,backgroundColor:\"black\"}}),/*#__PURE__*/React.createElement(Typography,{component:\"h2\",style:{fontSize:20,paddingTop:\"2%\"}},\"First Name\"),/*#__PURE__*/React.createElement(TextField,{fullWidth:true,autoFocus:true,autoComplete:true,variant:\"outlined\",style:{paddingBottom:10},onChange:this.handleFirstNameEdit}),/*#__PURE__*/React.createElement(Typography,{component:\"h2\",style:{fontSize:20}},\"Last Name\"),/*#__PURE__*/React.createElement(TextField,{fullWidth:true,autoComplete:true,variant:\"outlined\",style:{paddingBottom:10},onChange:function onChange(event){return _this2.handleLastNameEdit(event);}}),/*#__PURE__*/React.createElement(Typography,{component:\"h2\",style:{fontSize:20}},\"Phone Number\"),/*#__PURE__*/React.createElement(PhoneInput,{fullWidth:true,autoComplete:true,style:{height:\"40px\",paddingTop:\"5px\"},onChange:this.handlePhoneNumberEdit,defaultCountry:\"ca\",disableDropdown:\"true\",countryCodeEditable:\"false\"}),this.state.foodTransportationMethod===\"delivery\"?/*#__PURE__*/React.createElement(Typography,{component:\"h2\",style:{fontSize:20}},\"Delivery Address\"):\"\",this.state.foodTransportationMethod===\"delivery\"?/*#__PURE__*/React.createElement(TextField,{fullWidth:true,autoComplete:true,variant:\"outlined\",style:{paddingBottom:10},onChange:this.handleDeliveryAddressEdit}):\"\"),/*#__PURE__*/React.createElement(\"div\",{style:{padding:\"2%\",paddingRight:\"10%\",paddingLeft:\"10%\"}},/*#__PURE__*/React.createElement(Button,{fullWidth:true,disabled:this.state.disabled,onClick:this.handleRedirectToPlaceOrderConfirmPage,variant:\"contained\",style:{padding:\"2%\",fontSize:25,color:\"black\",backgroundImage:\"url(\".concat(buttonBackground,\")\"),filter:this.state.disabled?\"grayscale(100%)\":\"grayscale(0%)\",borderWidth:2,borderColor:\"black\",borderStyle:\"solid\"}},\"Place Order\"))))));}}]);return OrderConfirmationPage;}(Component);export default OrderConfirmationPage;","map":{"version":3,"sources":["/Users/kendric_chung/Projects/kingdo/src/Components/Checkout/OrderConfirmationPage.js"],"names":["React","Component","TopBar","Typography","TextField","Button","PhoneInput","Redirect","Link","Card","CardContent","Center","Axios","Helmet","parseItemIntoStack","MenuItem","FormControl","Select","buttonBackground","hostEndpoint","process","env","KINGDO_HOST_ENDPOINT","OrderConfirmationPage","props","handleFirstNameEdit","event","setState","firstNameText","target","value","disabled","length","state","lastNameText","phoneNumber","foodTransportationMethod","deliveryAddress","handleLastNameEdit","handleDeliveryAddressEdit","handlePhoneNumberEdit","replace","handleRedirectToPlaceOrderConfirmPage","JSON","parse","sessionStorage","getItem","stackItems","cartItemsAmount","method","params","customerPhoneNumber","firstName","lastName","transportationMethod","data","then","response","console","log","removeItem","error","redirectToPlaceOrderConfirmPage","handleFoodTransportationMethodChange","setItem","token","location","includes","pathname","padding","paddingRight","paddingLeft","fontSize","paddingBottom","width","height","backgroundColor","paddingTop","color","backgroundImage","filter","borderWidth","borderColor","borderStyle"],"mappings":"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","sourcesContent":["import React, { Component } from \"react\";\nimport TopBar from \"../Menu/MenuPage/TopBar\";\nimport Typography from \"@material-ui/core/Typography\";\nimport TextField from \"@material-ui/core/TextField\";\nimport Button from \"@material-ui/core/Button\";\nimport PhoneInput from \"material-ui-phone-number\";\nimport { Redirect, Link } from \"react-router-dom\";\nimport Card from \"@material-ui/core/Card\";\nimport CardContent from \"@material-ui/core/CardContent\";\nimport Center from \"react-center\";\nimport Axios from \"axios\";\nimport { Helmet } from \"react-helmet\";\nimport { parseItemIntoStack } from \"../Cart/CartPage\";\nimport MenuItem from \"@material-ui/core/MenuItem\";\nimport FormControl from \"@material-ui/core/FormControl\";\nimport Select from \"@material-ui/core/Select\";\nimport buttonBackground from \"../kingdo_background.png\";\n\nconst hostEndpoint = process.env.KINGDO_HOST_ENDPOINT\n  ? process.env.KINGDO_HOST_ENDPOINT\n  : \"http://localhost:3001\";\n\nclass OrderConfirmationPage extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      firstNameText: \"\",\n      lastNameText: \"\",\n      phoneNumber: \"\",\n      deliveryAddress: \"\",\n      token: props.location.state,\n      foodTransportationMethod: sessionStorage\n        .getItem(\"foodTransportMethod\")\n        .includes(\"delivery\")\n        ? \"delivery\"\n        : \"pickup\",\n      disabled: true,\n      redirectToPlaceOrderConfirmPage: false,\n    };\n  }\n\n  handleFirstNameEdit = (event) => {\n    this.setState({\n      firstNameText: event.target.value,\n      disabled:\n        event.target.value.length === 0 ||\n        this.state.lastNameText.length === 0 ||\n        this.state.phoneNumber.length <= 2 ||\n        (this.state.foodTransportationMethod === \"delivery\"\n          ? this.state.deliveryAddress.length === 0\n          : false),\n    });\n  };\n\n  handleLastNameEdit = (event) => {\n    this.setState({\n      lastNameText: event.target.value,\n      disabled:\n        event.target.value.length === 0 ||\n        this.state.firstNameText.length === 0 ||\n        this.state.phoneNumber.length <= 2 ||\n        (this.state.foodTransportationMethod === \"delivery\"\n          ? this.state.deliveryAddress.length === 0\n          : false),\n    });\n  };\n\n  handleDeliveryAddressEdit = (event) => {\n    this.setState({\n      deliveryAddress: event.target.value,\n      disabled:\n        event.target.value.length === 0 ||\n        this.state.firstNameText.length === 0 ||\n        this.state.phoneNumber.length <= 2 ||\n        this.state.lastNameText.length === 0,\n    });\n  };\n\n  handlePhoneNumberEdit = (value) => {\n    this.setState({\n      phoneNumber: value.replace(/\\(|\\)|-|\\s/g, \"\"),\n      disabled:\n        value.length <= 2 ||\n        this.state.lastNameText.length === 0 ||\n        this.state.firstNameText.length === 0 ||\n        (this.state.foodTransportationMethod === \"delivery\"\n          ? this.state.deliveryAddress.length === 0\n          : false),\n    });\n  };\n\n  handleRedirectToPlaceOrderConfirmPage = () => {\n    try {\n      const [stackItems, cartItemsAmount] = parseItemIntoStack(\n        JSON.parse(sessionStorage.getItem(\"cartItems\"))\n      );\n      Axios(`${hostEndpoint}/twilio/sms`, {\n        method: \"POST\",\n        params: {\n          customerPhoneNumber: this.state.phoneNumber,\n          firstName: this.state.firstNameText,\n          lastName: this.state.lastNameText,\n          transportationMethod: this.state.foodTransportationMethod,\n          deliveryAddress: this.state.deliveryAddress,\n        },\n        data: { stackItems, cartItemsAmount },\n      }).then((response) => {\n        console.log(response);\n        sessionStorage.removeItem(\"cartItems\");\n      });\n      // TODO: need to check if number of valid if not show that they need to pick up on next screen\n    } catch (error) {\n      console.log(error);\n    }\n    this.setState({ redirectToPlaceOrderConfirmPage: true });\n  };\n\n  handleFoodTransportationMethodChange = (event) => {\n    sessionStorage.setItem(\n      \"foodTransportMethod\",\n      event.target.value === \"delivery\" ? \"delivery\" : \"pickup\"\n    );\n    this.setState({\n      foodTransportationMethod: event.target.value,\n      disabled:\n        event.target.value === \"delivery\"\n          ? true\n          : this.state.firstNameText.length === 0 ||\n            this.state.phoneNumber.length <= 2 ||\n            this.state.lastNameText.length === 0,\n    });\n  };\n\n  render() {\n    if (!this.state.token) {\n      return (\n        <Center>\n          <h1>\n            Please return to the main page <Link to=\"/\">here</Link>.\n          </h1>\n        </Center>\n      );\n    }\n\n    if (this.state.redirectToPlaceOrderConfirmPage) {\n      return (\n        <Redirect\n          to={{\n            pathname: `/${this.state.foodTransportationMethod}/cart/order/confirmed/checkout`,\n            state: \"token\",\n            phoneNumber: this.state.phoneNumber,\n          }}\n        />\n      );\n    }\n\n    return (\n      <div>\n        <Helmet>\n          <title>King Do Restaurant | Order Confirm</title>\n        </Helmet>\n        <TopBar />\n        <div style={{ padding: \"2%\", paddingRight: \"5%\", paddingLeft: \"5%\" }}>\n          <Card>\n            <CardContent>\n              <div\n                style={{\n                  padding: \"2%\",\n                }}\n              >\n                <Typography component=\"h2\" style={{ fontSize: 20 }}>\n                  Please fill in the following to confirm that you will be\n                  paying for your order.\n                </Typography>\n                <Typography\n                  component=\"h2\"\n                  style={{ fontSize: 20, paddingBottom: \"2%\" }}\n                >\n                  Your payment will be received upon\n                  {this.state.foodTransportationMethod === \"deliver\"\n                    ? \" delivery\"\n                    : \" pick up\"}\n                  .\n                </Typography>\n                <Typography\n                  component=\"h2\"\n                  style={{ fontSize: 20, paddingBottom: \"1%\" }}\n                >\n                  You can still change between delivery and pick up here:\n                </Typography>\n                <FormControl\n                  variant=\"outlined\"\n                  style={{ width: \"25%\", paddingBottom: \"2%\" }}\n                >\n                  <Select\n                    labelId=\"demo-simple-select-outlined-label\"\n                    id=\"demo-simple-select-outlined\"\n                    value={this.state.foodTransportationMethod}\n                    onChange={(event) =>\n                      this.handleFoodTransportationMethodChange(event)\n                    }\n                  >\n                    <MenuItem value={\"delivery\"}>Delivery</MenuItem>\n                    <MenuItem value={\"pickup\"}>Pick Up</MenuItem>\n                  </Select>\n                </FormControl>\n                <div\n                  style={{ width: \"100%\", height: 1, backgroundColor: \"black\" }}\n                ></div>\n                <Typography\n                  component=\"h2\"\n                  style={{ fontSize: 20, paddingTop: \"2%\" }}\n                >\n                  First Name\n                </Typography>\n                <TextField\n                  fullWidth\n                  autoFocus\n                  autoComplete\n                  variant=\"outlined\"\n                  style={{ paddingBottom: 10 }}\n                  onChange={this.handleFirstNameEdit}\n                />\n                <Typography component=\"h2\" style={{ fontSize: 20 }}>\n                  Last Name\n                </Typography>\n                <TextField\n                  fullWidth\n                  autoComplete\n                  variant=\"outlined\"\n                  style={{ paddingBottom: 10 }}\n                  onChange={(event) => this.handleLastNameEdit(event)}\n                />\n                <Typography component=\"h2\" style={{ fontSize: 20 }}>\n                  Phone Number\n                </Typography>\n                <PhoneInput\n                  fullWidth\n                  autoComplete\n                  style={{ height: \"40px\", paddingTop: \"5px\" }}\n                  onChange={this.handlePhoneNumberEdit}\n                  defaultCountry=\"ca\"\n                  disableDropdown=\"true\"\n                  countryCodeEditable=\"false\"\n                />\n                {/* TODO: split by city name, street, and postal code */}\n                {this.state.foodTransportationMethod === \"delivery\" ? (\n                  <Typography component=\"h2\" style={{ fontSize: 20 }}>\n                    Delivery Address\n                  </Typography>\n                ) : (\n                  \"\"\n                )}\n                {this.state.foodTransportationMethod === \"delivery\" ? (\n                  <TextField\n                    fullWidth\n                    autoComplete\n                    variant=\"outlined\"\n                    style={{ paddingBottom: 10 }}\n                    onChange={this.handleDeliveryAddressEdit}\n                  />\n                ) : (\n                  \"\"\n                )}\n              </div>\n              <div\n                style={{\n                  padding: \"2%\",\n                  paddingRight: \"10%\",\n                  paddingLeft: \"10%\",\n                }}\n              >\n                <Button\n                  fullWidth\n                  disabled={this.state.disabled}\n                  onClick={this.handleRedirectToPlaceOrderConfirmPage}\n                  variant=\"contained\"\n                  style={{\n                    padding: \"2%\",\n                    fontSize: 25,\n                    color: \"black\",\n                    backgroundImage: `url(${buttonBackground})`,\n                    filter: this.state.disabled\n                      ? \"grayscale(100%)\"\n                      : \"grayscale(0%)\",\n                    borderWidth: 2,\n                    borderColor: \"black\",\n                    borderStyle: \"solid\",\n                  }}\n                >\n                  Place Order\n                </Button>\n              </div>\n            </CardContent>\n          </Card>\n        </div>\n      </div>\n    );\n  }\n}\n\nexport default OrderConfirmationPage;\n"]},"metadata":{},"sourceType":"module"}