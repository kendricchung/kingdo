{"ast":null,"code":"var _jsxFileName = \"/Users/kendric_chung/Projects/kingdo/src/Components/Cart/CartPage.js\";\nimport React, { Component } from \"react\";\nimport TopBar from \"../Menu/MenuPage/TopBar\";\nimport ScrollToTop from \"react-scroll-to-top\";\nimport Card from \"@material-ui/core/Card\";\nimport CardActions from \"@material-ui/core/CardActions\";\nimport CardContent from \"@material-ui/core/CardContent\";\nimport Button from \"@material-ui/core/Button\";\nimport Typography from \"@material-ui/core/Typography\";\nimport { Redirect } from \"react-router-dom\";\nimport AddCircleIcon from \"@material-ui/icons/AddCircle\";\nimport RemoveCircleIcon from \"@material-ui/icons/RemoveCircle\";\nimport IconButton from \"@material-ui/core/IconButton\";\nimport { Helmet } from \"react-helmet\";\nimport Box from \"@material-ui/core/Box\";\nimport buttonBackground from \"../kingdo_background.png\";\nexport const parseItemIntoStack = items => {\n  let map = new Map();\n\n  for (const item of items) {\n    if (!map.has(item.id)) {\n      map.set(item.id, [item]);\n    } else {\n      let listOfItemsWithGivenId = map.get(item.id);\n      listOfItemsWithGivenId.push(item);\n      map.set(item.id, listOfItemsWithGivenId);\n    }\n  }\n\n  let numberOfItemsCounter = 0;\n  let listOfItems = [];\n  map.forEach((value, key) => {\n    listOfItems.push({\n      quantity: value.length,\n      item: value[0]\n    });\n    numberOfItemsCounter += value.length;\n  });\n  return [listOfItems, numberOfItemsCounter];\n};\nexport const calculateAmountsGivenStackItems = stackItems => {\n  if (stackItems.length === 0) {\n    return [0, 0, 0];\n  }\n\n  let price = 0;\n  stackItems.forEach(value => {\n    price += value.quantity * parseFloat((Math.round(parseFloat(value.item.price, 10) * 100) / 100).toFixed(2));\n  });\n  const subtotalPrice = parseFloat((Math.round(parseFloat(price, 10) * 100) / 100).toFixed(2));\n  const taxPrice = parseFloat((Math.round(subtotalPrice * 0.05 * 100) / 100).toFixed(2));\n  const totalPrice = parseFloat((Math.round(parseFloat(subtotalPrice + taxPrice, 10) * 100) / 100).toFixed(2));\n  return [subtotalPrice, taxPrice, totalPrice];\n};\n\nclass CartPage extends Component {\n  constructor(props) {\n    super(props);\n\n    this.handleRedirectToOrderConfirmationPage = () => {\n      this.setState({\n        redirectToOrderConfirmationPage: true\n      });\n    };\n\n    this.handleRemoveItems = itemId => {\n      let currentStackItems = this.state.itemStack; // This creates the new stack of items\n\n      let newStackItems = [];\n      currentStackItems.forEach(value => {\n        if (value.item.id !== itemId) {\n          newStackItems.push(value);\n        }\n      }); // This creates the new cart items\n\n      let newCartItems = [];\n      newStackItems.forEach(value => {\n        for (let i = 0; i < value.quantity; i++) {\n          newCartItems.push(value.item);\n        }\n      }); // Set to session storage\n\n      sessionStorage.setItem(\"cartItems\", JSON.stringify(newCartItems)); // Calculate the new amounts\n\n      const [subtotalPrice, taxPrice, totalPrice] = calculateAmountsGivenStackItems(newStackItems);\n      this.setState({\n        buttonDisabled: newStackItems.length === 0,\n        itemStack: newStackItems,\n        totalNumberOfItems: newCartItems.length,\n        subtotalPrice: subtotalPrice,\n        taxPrice: taxPrice,\n        totalPrice: totalPrice\n      });\n    };\n\n    this.handleIncreaseQuantityByOne = itemId => {\n      let currentStackItems = this.state.itemStack;\n      currentStackItems.forEach(value => {\n        if (value.item.id === itemId) {\n          value.quantity++;\n          return;\n        }\n      });\n      let newCartItems = [];\n      currentStackItems.forEach(value => {\n        for (let i = 0; i < value.quantity; i++) {\n          newCartItems.push(value.item);\n        }\n      }); // Set to session storage\n\n      sessionStorage.setItem(\"cartItems\", JSON.stringify(newCartItems)); // Calculate the new amounts\n\n      const [subtotalPrice, taxPrice, totalPrice] = calculateAmountsGivenStackItems(currentStackItems);\n      this.setState({\n        itemStack: currentStackItems,\n        totalNumberOfItems: newCartItems.length,\n        subtotalPrice: subtotalPrice,\n        taxPrice: taxPrice,\n        totalPrice: totalPrice\n      });\n    };\n\n    this.handleDecreaseQuantityByOne = itemId => {\n      let currentStackItems = this.state.itemStack;\n      let newStackItems = [];\n      let removeItem = false;\n      currentStackItems.forEach(value => {\n        if (value.item.id === itemId) {\n          value.quantity--;\n\n          if (value.quantity === 0) {\n            removeItem = true;\n          }\n\n          return;\n        }\n      });\n      let updatedStackItems = [];\n\n      if (removeItem && currentStackItems.length > 1) {\n        currentStackItems.forEach(value => {\n          if (value.item.id !== itemId) {\n            newStackItems.push(value);\n          }\n        });\n        updatedStackItems = newStackItems;\n      } else if (!removeItem && currentStackItems.length > 0) {\n        updatedStackItems = currentStackItems;\n      }\n\n      let newCartItems = [];\n      currentStackItems.forEach(value => {\n        for (let i = 0; i < value.quantity; i++) {\n          newCartItems.push(value.item);\n        }\n      }); // Set to session storage\n\n      sessionStorage.setItem(\"cartItems\", JSON.stringify(newCartItems)); // Calculate the new amounts\n\n      const [subtotalPrice, taxPrice, totalPrice] = calculateAmountsGivenStackItems(updatedStackItems);\n      this.setState({\n        buttonDisabled: updatedStackItems.length === 0,\n        itemStack: updatedStackItems,\n        totalNumberOfItems: newCartItems.length,\n        subtotalPrice: subtotalPrice,\n        taxPrice: taxPrice,\n        totalPrice: totalPrice\n      });\n    };\n\n    const storageCartItems = JSON.parse(sessionStorage.getItem(\"cartItems\")) ? JSON.parse(sessionStorage.getItem(\"cartItems\")) : [];\n    const [listOfItems, numberOfItemsCounter] = parseItemIntoStack(storageCartItems);\n    const [_subtotalPrice, _taxPrice, _totalPrice] = calculateAmountsGivenStackItems(listOfItems);\n    this.state = {\n      itemStack: listOfItems,\n      subtotalPrice: _subtotalPrice,\n      taxPrice: _taxPrice,\n      totalPrice: _totalPrice,\n      totalNumberOfItems: numberOfItemsCounter,\n      foodTransportationMethod: props.location.pathname.includes(\"delivery\") ? \"delivery\" : \"pickup\",\n      redirectToOrderConfirmationPage: false,\n      buttonDisabled: storageCartItems.length === 0 ? true : false\n    };\n  }\n\n  render() {\n    if (this.state.redirectToOrderConfirmationPage) {\n      return /*#__PURE__*/React.createElement(Redirect, {\n        push: true,\n        to: {\n          pathname: `/${this.state.foodTransportationMethod}/cart/order/confirmed`,\n          state: \"token\"\n        },\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 231,\n          columnNumber: 9\n        }\n      });\n    }\n\n    return /*#__PURE__*/React.createElement(\"div\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 242,\n        columnNumber: 7\n      }\n    }, /*#__PURE__*/React.createElement(Helmet, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 243,\n        columnNumber: 9\n      }\n    }, /*#__PURE__*/React.createElement(\"title\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 244,\n        columnNumber: 11\n      }\n    }, \"King Do Restaurant | Cart\")), /*#__PURE__*/React.createElement(ScrollToTop, {\n      smooth: true,\n      style: {\n        position: \"fixed\",\n        borderStyle: \"solid\",\n        borderWidth: 1,\n        borderColor: \"#83858a\"\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 246,\n        columnNumber: 9\n      }\n    }), /*#__PURE__*/React.createElement(TopBar, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 255,\n        columnNumber: 9\n      }\n    }), /*#__PURE__*/React.createElement(\"div\", {\n      style: {\n        display: \"flex\"\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 256,\n        columnNumber: 9\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 257,\n        columnNumber: 11\n      }\n    }, this.state.itemStack.length === 0 ? /*#__PURE__*/React.createElement(\"div\", {\n      style: {\n        padding: 40\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 259,\n        columnNumber: 15\n      }\n    }, /*#__PURE__*/React.createElement(Typography, {\n      variant: \"h5\",\n      component: \"h2\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 260,\n        columnNumber: 17\n      }\n    }, \"You currently don't have any items in your cart.\"), /*#__PURE__*/React.createElement(Typography, {\n      variant: \"h5\",\n      component: \"h2\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 263,\n        columnNumber: 17\n      }\n    }, \"Please add them from the menu page to proceed to checkout.\")) : this.state.itemStack.map(value => /*#__PURE__*/React.createElement(\"div\", {\n      style: {\n        paddingLeft: window.outerWidth * 0.02,\n        paddingRight: window.outerWidth * 0.05,\n        paddingTop: window.outerHeight * 0.05,\n        paddingBottom: window.outerHeight * 0.05,\n        width: window.outerWidth * 0.4\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 269,\n        columnNumber: 17\n      }\n    }, /*#__PURE__*/React.createElement(Card, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 278,\n        columnNumber: 19\n      }\n    }, /*#__PURE__*/React.createElement(CardContent, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 279,\n        columnNumber: 21\n      }\n    }, /*#__PURE__*/React.createElement(Typography, {\n      variant: \"h5\",\n      component: \"h2\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 280,\n        columnNumber: 23\n      }\n    }, value.item.name), /*#__PURE__*/React.createElement(Typography, {\n      color: \"textSecondary\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 283,\n        columnNumber: 23\n      }\n    }, \"$\", value.item.price), /*#__PURE__*/React.createElement(Typography, {\n      color: \"textSecondary\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 286,\n        columnNumber: 23\n      }\n    }, \"Quantity:\"), /*#__PURE__*/React.createElement(\"div\", {\n      style: {\n        display: \"flex\"\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 287,\n        columnNumber: 23\n      }\n    }, /*#__PURE__*/React.createElement(Typography, {\n      style: {\n        fontSize: 20,\n        padding: 10\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 288,\n        columnNumber: 25\n      }\n    }, value.quantity), /*#__PURE__*/React.createElement(IconButton, {\n      color: \"grey\",\n      onClick: () => this.handleIncreaseQuantityByOne(value.item.id),\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 291,\n        columnNumber: 25\n      }\n    }, /*#__PURE__*/React.createElement(AddCircleIcon, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 297,\n        columnNumber: 27\n      }\n    })), /*#__PURE__*/React.createElement(IconButton, {\n      color: \"grey\",\n      onClick: () => this.handleDecreaseQuantityByOne(value.item.id),\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 299,\n        columnNumber: 25\n      }\n    }, /*#__PURE__*/React.createElement(RemoveCircleIcon, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 305,\n        columnNumber: 27\n      }\n    })))), /*#__PURE__*/React.createElement(CardActions, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 309,\n        columnNumber: 21\n      }\n    }, /*#__PURE__*/React.createElement(Button, {\n      size: \"large\",\n      color: \"secondary\",\n      onClick: () => this.handleRemoveItems(value.item.id),\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 310,\n        columnNumber: 23\n      }\n    }, \"Delete\")))))), /*#__PURE__*/React.createElement(\"div\", {\n      style: {\n        paddingLeft: window.outerWidth * 0.05,\n        paddingRight: window.outerWidth * 0.02,\n        paddingTop: window.outerHeight * 0.05,\n        paddingBottom: window.outerHeight * 0.05,\n        width: window.outerWidth * 0.45,\n        position: \"fixed\",\n        right: 0\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 323,\n        columnNumber: 11\n      }\n    }, /*#__PURE__*/React.createElement(Card, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 334,\n        columnNumber: 13\n      }\n    }, /*#__PURE__*/React.createElement(CardContent, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 335,\n        columnNumber: 15\n      }\n    }, /*#__PURE__*/React.createElement(Typography, {\n      variant: \"h5\",\n      component: \"h2\",\n      style: {\n        fontSize: 30\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 336,\n        columnNumber: 17\n      }\n    }, \"Order Summary\"), /*#__PURE__*/React.createElement(\"span\", {\n      style: {\n        padding: \"10%\"\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 343,\n        columnNumber: 17\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      style: {\n        display: \"flex\",\n        justifyContent: \"space-between\"\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 344,\n        columnNumber: 19\n      }\n    }, /*#__PURE__*/React.createElement(Typography, {\n      component: \"h2\",\n      style: {\n        fontSize: 20\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 347,\n        columnNumber: 21\n      }\n    }, \"Items:\"), /*#__PURE__*/React.createElement(Typography, {\n      component: \"h2\",\n      style: {\n        fontSize: 20\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 350,\n        columnNumber: 21\n      }\n    }, this.state.totalNumberOfItems)), /*#__PURE__*/React.createElement(\"div\", {\n      style: {\n        display: \"flex\",\n        justifyContent: \"space-between\"\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 354,\n        columnNumber: 19\n      }\n    }, /*#__PURE__*/React.createElement(Typography, {\n      component: \"h2\",\n      style: {\n        fontSize: 20\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 357,\n        columnNumber: 21\n      }\n    }, \"Subtotal:\"), /*#__PURE__*/React.createElement(Typography, {\n      component: \"h2\",\n      style: {\n        fontSize: 20\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 360,\n        columnNumber: 21\n      }\n    }, \"$\", this.state.subtotalPrice)), /*#__PURE__*/React.createElement(\"div\", {\n      style: {\n        display: \"flex\",\n        justifyContent: \"space-between\"\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 364,\n        columnNumber: 19\n      }\n    }, /*#__PURE__*/React.createElement(Typography, {\n      component: \"h2\",\n      style: {\n        fontSize: 20\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 367,\n        columnNumber: 21\n      }\n    }, \"Tax (GST):\"), /*#__PURE__*/React.createElement(Typography, {\n      component: \"h2\",\n      style: {\n        fontSize: 20\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 370,\n        columnNumber: 21\n      }\n    }, \"$\", this.state.taxPrice)), /*#__PURE__*/React.createElement(\"div\", {\n      style: {\n        paddingTop: window.outerHeight * 0.02,\n        paddingBottom: window.outerHeight * 0.02\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 374,\n        columnNumber: 19\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      style: {\n        width: \"100%\",\n        height: 2,\n        backgroundColor: \"black\"\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 380,\n        columnNumber: 21\n      }\n    })), /*#__PURE__*/React.createElement(\"div\", {\n      style: {\n        display: \"flex\",\n        justifyContent: \"space-between\"\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 388,\n        columnNumber: 19\n      }\n    }, /*#__PURE__*/React.createElement(Typography, {\n      component: \"h2\",\n      style: {\n        fontSize: 30\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 391,\n        columnNumber: 21\n      }\n    }, \"Total:\"), /*#__PURE__*/React.createElement(Typography, {\n      component: \"h2\",\n      style: {\n        fontSize: 30\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 394,\n        columnNumber: 21\n      }\n    }, \"$\", this.state.totalPrice)))), /*#__PURE__*/React.createElement(\"div\", {\n      style: {\n        padding: \"2%\"\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 400,\n        columnNumber: 15\n      }\n    }, /*#__PURE__*/React.createElement(Button, {\n      fullWidth: true,\n      disabled: this.state.buttonDisabled,\n      onClick: this.handleRedirectToOrderConfirmationPage,\n      variant: \"contained\",\n      style: {\n        borderStyle: \"solid\",\n        border: \"black\",\n        backgroundImage: `url(${buttonBackground})`,\n        fontSize: 20,\n        borderRadius: 0,\n        color: \"black\",\n        filter: this.state.buttonDisabled ? \"grayscale(100%)\" : \"grayscale(0%)\"\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 402,\n        columnNumber: 17\n      }\n    }, \"Confirm Order\"))))));\n  }\n\n}\n\nexport default CartPage;","map":{"version":3,"sources":["/Users/kendric_chung/Projects/kingdo/src/Components/Cart/CartPage.js"],"names":["React","Component","TopBar","ScrollToTop","Card","CardActions","CardContent","Button","Typography","Redirect","AddCircleIcon","RemoveCircleIcon","IconButton","Helmet","Box","buttonBackground","parseItemIntoStack","items","map","Map","item","has","id","set","listOfItemsWithGivenId","get","push","numberOfItemsCounter","listOfItems","forEach","value","key","quantity","length","calculateAmountsGivenStackItems","stackItems","price","parseFloat","Math","round","toFixed","subtotalPrice","taxPrice","totalPrice","CartPage","constructor","props","handleRedirectToOrderConfirmationPage","setState","redirectToOrderConfirmationPage","handleRemoveItems","itemId","currentStackItems","state","itemStack","newStackItems","newCartItems","i","sessionStorage","setItem","JSON","stringify","buttonDisabled","totalNumberOfItems","handleIncreaseQuantityByOne","handleDecreaseQuantityByOne","removeItem","updatedStackItems","storageCartItems","parse","getItem","foodTransportationMethod","location","pathname","includes","render","position","borderStyle","borderWidth","borderColor","display","padding","paddingLeft","window","outerWidth","paddingRight","paddingTop","outerHeight","paddingBottom","width","name","fontSize","right","justifyContent","height","backgroundColor","border","backgroundImage","borderRadius","color","filter"],"mappings":"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","sourcesContent":["import React, { Component } from \"react\";\nimport TopBar from \"../Menu/MenuPage/TopBar\";\nimport ScrollToTop from \"react-scroll-to-top\";\nimport Card from \"@material-ui/core/Card\";\nimport CardActions from \"@material-ui/core/CardActions\";\nimport CardContent from \"@material-ui/core/CardContent\";\nimport Button from \"@material-ui/core/Button\";\nimport Typography from \"@material-ui/core/Typography\";\nimport { Redirect } from \"react-router-dom\";\nimport AddCircleIcon from \"@material-ui/icons/AddCircle\";\nimport RemoveCircleIcon from \"@material-ui/icons/RemoveCircle\";\nimport IconButton from \"@material-ui/core/IconButton\";\nimport { Helmet } from \"react-helmet\";\nimport Box from \"@material-ui/core/Box\";\nimport buttonBackground from \"../kingdo_background.png\";\n\nexport const parseItemIntoStack = (items) => {\n  let map = new Map();\n  for (const item of items) {\n    if (!map.has(item.id)) {\n      map.set(item.id, [item]);\n    } else {\n      let listOfItemsWithGivenId = map.get(item.id);\n      listOfItemsWithGivenId.push(item);\n      map.set(item.id, listOfItemsWithGivenId);\n    }\n  }\n  let numberOfItemsCounter = 0;\n  let listOfItems = [];\n  map.forEach((value, key) => {\n    listOfItems.push({\n      quantity: value.length,\n      item: value[0],\n    });\n    numberOfItemsCounter += value.length;\n  });\n\n  return [listOfItems, numberOfItemsCounter];\n};\n\nexport const calculateAmountsGivenStackItems = (stackItems) => {\n  if (stackItems.length === 0) {\n    return [0, 0, 0];\n  }\n  let price = 0;\n  stackItems.forEach((value) => {\n    price +=\n      value.quantity *\n      parseFloat(\n        (Math.round(parseFloat(value.item.price, 10) * 100) / 100).toFixed(2)\n      );\n  });\n\n  const subtotalPrice = parseFloat(\n    (Math.round(parseFloat(price, 10) * 100) / 100).toFixed(2)\n  );\n  const taxPrice = parseFloat(\n    (Math.round(subtotalPrice * 0.05 * 100) / 100).toFixed(2)\n  );\n\n  const totalPrice = parseFloat(\n    (Math.round(parseFloat(subtotalPrice + taxPrice, 10) * 100) / 100).toFixed(\n      2\n    )\n  );\n\n  return [subtotalPrice, taxPrice, totalPrice];\n};\n\nclass CartPage extends Component {\n  constructor(props) {\n    super(props);\n\n    const storageCartItems = JSON.parse(sessionStorage.getItem(\"cartItems\"))\n      ? JSON.parse(sessionStorage.getItem(\"cartItems\"))\n      : [];\n\n    const [listOfItems, numberOfItemsCounter] = parseItemIntoStack(\n      storageCartItems\n    );\n\n    const [\n      subtotalPrice,\n      taxPrice,\n      totalPrice,\n    ] = calculateAmountsGivenStackItems(listOfItems);\n\n    this.state = {\n      itemStack: listOfItems,\n      subtotalPrice: subtotalPrice,\n      taxPrice: taxPrice,\n      totalPrice: totalPrice,\n      totalNumberOfItems: numberOfItemsCounter,\n      foodTransportationMethod: props.location.pathname.includes(\"delivery\")\n        ? \"delivery\"\n        : \"pickup\",\n      redirectToOrderConfirmationPage: false,\n      buttonDisabled: storageCartItems.length === 0 ? true : false,\n    };\n  }\n\n  handleRedirectToOrderConfirmationPage = () => {\n    this.setState({ redirectToOrderConfirmationPage: true });\n  };\n\n  handleRemoveItems = (itemId) => {\n    let currentStackItems = this.state.itemStack;\n    // This creates the new stack of items\n    let newStackItems = [];\n    currentStackItems.forEach((value) => {\n      if (value.item.id !== itemId) {\n        newStackItems.push(value);\n      }\n    });\n    // This creates the new cart items\n    let newCartItems = [];\n    newStackItems.forEach((value) => {\n      for (let i = 0; i < value.quantity; i++) {\n        newCartItems.push(value.item);\n      }\n    });\n    // Set to session storage\n    sessionStorage.setItem(\"cartItems\", JSON.stringify(newCartItems));\n\n    // Calculate the new amounts\n    const [\n      subtotalPrice,\n      taxPrice,\n      totalPrice,\n    ] = calculateAmountsGivenStackItems(newStackItems);\n\n    this.setState({\n      buttonDisabled: newStackItems.length === 0,\n      itemStack: newStackItems,\n      totalNumberOfItems: newCartItems.length,\n      subtotalPrice: subtotalPrice,\n      taxPrice: taxPrice,\n      totalPrice: totalPrice,\n    });\n  };\n\n  handleIncreaseQuantityByOne = (itemId) => {\n    let currentStackItems = this.state.itemStack;\n    currentStackItems.forEach((value) => {\n      if (value.item.id === itemId) {\n        value.quantity++;\n        return;\n      }\n    });\n\n    let newCartItems = [];\n    currentStackItems.forEach((value) => {\n      for (let i = 0; i < value.quantity; i++) {\n        newCartItems.push(value.item);\n      }\n    });\n\n    // Set to session storage\n    sessionStorage.setItem(\"cartItems\", JSON.stringify(newCartItems));\n\n    // Calculate the new amounts\n    const [\n      subtotalPrice,\n      taxPrice,\n      totalPrice,\n    ] = calculateAmountsGivenStackItems(currentStackItems);\n\n    this.setState({\n      itemStack: currentStackItems,\n      totalNumberOfItems: newCartItems.length,\n      subtotalPrice: subtotalPrice,\n      taxPrice: taxPrice,\n      totalPrice: totalPrice,\n    });\n  };\n\n  handleDecreaseQuantityByOne = (itemId) => {\n    let currentStackItems = this.state.itemStack;\n    let newStackItems = [];\n    let removeItem = false;\n    currentStackItems.forEach((value) => {\n      if (value.item.id === itemId) {\n        value.quantity--;\n        if (value.quantity === 0) {\n          removeItem = true;\n        }\n        return;\n      }\n    });\n    let updatedStackItems = [];\n\n    if (removeItem && currentStackItems.length > 1) {\n      currentStackItems.forEach((value) => {\n        if (value.item.id !== itemId) {\n          newStackItems.push(value);\n        }\n      });\n      updatedStackItems = newStackItems;\n    } else if (!removeItem && currentStackItems.length > 0) {\n      updatedStackItems = currentStackItems;\n    }\n\n    let newCartItems = [];\n    currentStackItems.forEach((value) => {\n      for (let i = 0; i < value.quantity; i++) {\n        newCartItems.push(value.item);\n      }\n    });\n    // Set to session storage\n    sessionStorage.setItem(\"cartItems\", JSON.stringify(newCartItems));\n    // Calculate the new amounts\n    const [\n      subtotalPrice,\n      taxPrice,\n      totalPrice,\n    ] = calculateAmountsGivenStackItems(updatedStackItems);\n\n    this.setState({\n      buttonDisabled: updatedStackItems.length === 0,\n      itemStack: updatedStackItems,\n      totalNumberOfItems: newCartItems.length,\n      subtotalPrice: subtotalPrice,\n      taxPrice: taxPrice,\n      totalPrice: totalPrice,\n    });\n  };\n\n  render() {\n    if (this.state.redirectToOrderConfirmationPage) {\n      return (\n        <Redirect\n          push\n          to={{\n            pathname: `/${this.state.foodTransportationMethod}/cart/order/confirmed`,\n            state: \"token\",\n          }}\n        />\n      );\n    }\n\n    return (\n      <div>\n        <Helmet>\n          <title>King Do Restaurant | Cart</title>\n        </Helmet>\n        <ScrollToTop\n          smooth\n          style={{\n            position: \"fixed\",\n            borderStyle: \"solid\",\n            borderWidth: 1,\n            borderColor: \"#83858a\",\n          }}\n        />\n        <TopBar />\n        <div style={{ display: \"flex\" }}>\n          <div>\n            {this.state.itemStack.length === 0 ? (\n              <div style={{ padding: 40 }}>\n                <Typography variant=\"h5\" component=\"h2\">\n                  You currently don't have any items in your cart.\n                </Typography>\n                <Typography variant=\"h5\" component=\"h2\">\n                  Please add them from the menu page to proceed to checkout.\n                </Typography>\n              </div>\n            ) : (\n              this.state.itemStack.map((value) => (\n                <div\n                  style={{\n                    paddingLeft: window.outerWidth * 0.02,\n                    paddingRight: window.outerWidth * 0.05,\n                    paddingTop: window.outerHeight * 0.05,\n                    paddingBottom: window.outerHeight * 0.05,\n                    width: window.outerWidth * 0.4,\n                  }}\n                >\n                  <Card>\n                    <CardContent>\n                      <Typography variant=\"h5\" component=\"h2\">\n                        {value.item.name}\n                      </Typography>\n                      <Typography color=\"textSecondary\">\n                        ${value.item.price}\n                      </Typography>\n                      <Typography color=\"textSecondary\">Quantity:</Typography>\n                      <div style={{ display: \"flex\" }}>\n                        <Typography style={{ fontSize: 20, padding: 10 }}>\n                          {value.quantity}\n                        </Typography>\n                        <IconButton\n                          color=\"grey\"\n                          onClick={() =>\n                            this.handleIncreaseQuantityByOne(value.item.id)\n                          }\n                        >\n                          <AddCircleIcon />\n                        </IconButton>\n                        <IconButton\n                          color=\"grey\"\n                          onClick={() =>\n                            this.handleDecreaseQuantityByOne(value.item.id)\n                          }\n                        >\n                          <RemoveCircleIcon />\n                        </IconButton>\n                      </div>\n                    </CardContent>\n                    <CardActions>\n                      <Button\n                        size=\"large\"\n                        color=\"secondary\"\n                        onClick={() => this.handleRemoveItems(value.item.id)}\n                      >\n                        Delete\n                      </Button>\n                    </CardActions>\n                  </Card>\n                </div>\n              ))\n            )}\n          </div>\n          <div\n            style={{\n              paddingLeft: window.outerWidth * 0.05,\n              paddingRight: window.outerWidth * 0.02,\n              paddingTop: window.outerHeight * 0.05,\n              paddingBottom: window.outerHeight * 0.05,\n              width: window.outerWidth * 0.45,\n              position: \"fixed\",\n              right: 0,\n            }}\n          >\n            <Card>\n              <CardContent>\n                <Typography\n                  variant=\"h5\"\n                  component=\"h2\"\n                  style={{ fontSize: 30 }}\n                >\n                  Order Summary\n                </Typography>\n                <span style={{ padding: \"10%\" }}>\n                  <div\n                    style={{ display: \"flex\", justifyContent: \"space-between\" }}\n                  >\n                    <Typography component=\"h2\" style={{ fontSize: 20 }}>\n                      Items:\n                    </Typography>\n                    <Typography component=\"h2\" style={{ fontSize: 20 }}>\n                      {this.state.totalNumberOfItems}\n                    </Typography>\n                  </div>\n                  <div\n                    style={{ display: \"flex\", justifyContent: \"space-between\" }}\n                  >\n                    <Typography component=\"h2\" style={{ fontSize: 20 }}>\n                      Subtotal:\n                    </Typography>\n                    <Typography component=\"h2\" style={{ fontSize: 20 }}>\n                      ${this.state.subtotalPrice}\n                    </Typography>\n                  </div>\n                  <div\n                    style={{ display: \"flex\", justifyContent: \"space-between\" }}\n                  >\n                    <Typography component=\"h2\" style={{ fontSize: 20 }}>\n                      Tax (GST):\n                    </Typography>\n                    <Typography component=\"h2\" style={{ fontSize: 20 }}>\n                      ${this.state.taxPrice}\n                    </Typography>\n                  </div>\n                  <div\n                    style={{\n                      paddingTop: window.outerHeight * 0.02,\n                      paddingBottom: window.outerHeight * 0.02,\n                    }}\n                  >\n                    <div\n                      style={{\n                        width: \"100%\",\n                        height: 2,\n                        backgroundColor: \"black\",\n                      }}\n                    ></div>\n                  </div>\n                  <div\n                    style={{ display: \"flex\", justifyContent: \"space-between\" }}\n                  >\n                    <Typography component=\"h2\" style={{ fontSize: 30 }}>\n                      Total:\n                    </Typography>\n                    <Typography component=\"h2\" style={{ fontSize: 30 }}>\n                      ${this.state.totalPrice}\n                    </Typography>\n                  </div>\n                </span>\n              </CardContent>\n              <div style={{ padding: \"2%\" }}>\n                {/* <Box border={2}> */}\n                <Button\n                  fullWidth\n                  disabled={this.state.buttonDisabled}\n                  onClick={this.handleRedirectToOrderConfirmationPage}\n                  variant=\"contained\"\n                  style={{\n                    borderStyle: \"solid\",\n                    border: \"black\",\n                    backgroundImage: `url(${buttonBackground})`,\n                    fontSize: 20,\n                    borderRadius: 0,\n                    color: \"black\",\n                    filter: this.state.buttonDisabled\n                      ? \"grayscale(100%)\"\n                      : \"grayscale(0%)\",\n                  }}\n                >\n                  Confirm Order\n                </Button>\n                {/* </Box> */}\n              </div>\n            </Card>\n          </div>\n        </div>\n      </div>\n    );\n  }\n}\n\nexport default CartPage;\n"]},"metadata":{},"sourceType":"module"}